########################################################################################
#                                         											   #
# AVE MARIA events																	   #
# A Very Extensive Modification for Appropriate Realism and Improved Authenticity	   #
#                                         											   #
# ID AVE_MARIA_roman_administration.1 - AVE_MARIA_roman_administration.499			   #
#                               													   #
########################################################################################

# Written by Atreides

namespace = AVE_MARIA_roman_administration

##NOTES:
## QOL event in order not to change every single history file
## 
character_event = {
	id = AVE_MARIA_roman_administration.1
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		is_save_game = no
		primary_title = {
			OR = { 
				title = e_byzantium
				title = e_roman_empire
			}
			has_law = succ_byzantine_elective
		}
	}
	
	immediate = {
				
		## 1066 start date - create specific titles and add specific titles to specific people
			
		
		any_title = { # Remove vanilla ducal title holders and give them to civilian_theme_new_holder and create military theme titles for previous aristocrat
			limit = {
				tier = DUKE
				NOT = { tier = KING	}
				NOT = { is_theocracy = yes }
				NOT = { title = d_varangian_guard }
				has_holder = yes	
				holder_scope = {			
					is_vassal_or_below_of = ROOT
					NOT = { character = ROOT }
				}
			}
			holder_scope = {
				add_hexaco_education_traits = yes
				save_event_target_as = target_military_theme_holder
				capital_scope = {				
					save_event_target_as = target_location_military_theme_capital			
				}
			}
			create_title = { # Military Theme title - Create the military theme title	
				tier = DUKE
				landless = yes
				temporary = no
				rebel = no
				culture = event_target:target_military_theme_holder
				name = MILITARY_THEME_TITLE
				holder = event_target:target_military_theme_holder
				custom_created = yes
				base_title = THIS
				copy_title_laws = yes
				mercenary = no
				adventurer = no
				ruler = "Strategos"
				ruler_female = "Strategos"
				foa = "My Strategos"
			}
			new_title = { # Set title flags and laws
				set_title_flag = created_military_theme_title
				add_law = {		
					law = succ_my_test_law	
					cooldown = no 	
					opinion_effect = no	
				}		
				add_law = {		
					law = agnatic_succession	
					cooldown = no 	
					opinion_effect = no	
				}
			}
			if = { # if under age or has already a family titular title do not create it
				limit = {
					holder_scope = {
						is_adult = yes
						any_demesne_title = {
							NOT = { has_title_flag = created_family_county_title }
						}
					}
				}
				create_title = { # Family Titular title - Create Family titular county title	
					tier = COUNT
					landless = yes
					temporary = no
					rebel = no
					culture = event_target:target_military_theme_holder
					name = FAMILY_COUNT_TITLE
					holder = event_target:target_military_theme_holder
					custom_created = yes
					base_title = THIS
					copy_title_laws = yes
					mercenary = no
					adventurer = no
					ruler = "Eugeneios"
					ruler_female = "Eugeneia"
					foa = "My Eugeneios"
				}
				new_title = {
					set_title_flag = created_family_county_title
					add_law = {		
						law = succ_primogeniture	
						cooldown = no 	
						opinion_effect = no	
					}		
					add_law = {		
						law = agnatic_succession	
						cooldown = no 	
						opinion_effect = no	
					}
				}
			}
			holder_scope = { # Creating the civilian theme new holder and the military theme new older if character is too young and give them the titles
				create_random_steward = {			
					random_traits = yes		
					dynasty = random		
					female = no		
					attributes = {		
						diplomacy = 2	
						learning = 2	
						stewardship = 8	
						intrigue = 2	
						martial = 2	
					}		
				}			
				new_character = {			
					save_event_target_as = civilian_theme_new_holder		
					set_character_flag = civilian_theme_new_holder		
				}
				if = { # Creating the military theme new holder if character is too young and give the new title to them
					limit = {
						is_adult = no
					}
					clear_event_target = target_military_theme_holder
					spawn_great_commander_effect = yes
					new_character = {			
						save_event_target_as = military_theme_new_holder		
						set_character_flag = military_theme_new_holder		
					}
					any_demesne_title = {
						limit = {
							has_title_flag = created_military_theme_title
						}
						grant_title_no_opinion = event_target:military_theme_new_holder
					}
				}
				any_title_under = { # Give to the civilian guy the vanilla ducal title and everything
					limit = {			
						NOT = { 
							tier = baron 
							OR = {
								has_title_flag = created_family_county_title
								has_title_flag = created_military_theme_title
								has_title_flag = roman_administration_tagma_title
								has_title_flag = roman_administration_domestikos_east_title
								has_title_flag = roman_administration_domestikos_west_title
							}
						}		
					}			
					grant_title_no_opinion = event_target:civilian_theme_new_holder			
				}
				if = { # Create the military thematic relationship otherwise you are fucking lost - when vanilla ducal title holder was not underage
					limit = {
						is_adult = yes
					}
					event_target:civilian_theme_new_holder = {
						make_tributary = {
							who = PREV
							tributary_type = theme_military
						}
					}
					
				}
				if = { # Create the military thematic relationship otherwise you are fucking lost - when vanilla ducal title holder was underage
					limit = {
						is_adult = no
					}
					event_target:civilian_theme_new_holder = {
						make_tributary = {
							who = event_target:military_theme_new_holder
							tributary_type = theme_military
						}
					}
				}
			}
			
			set_title_flag = roman_administration_civilian_theme
			add_law = {	
				law = succ_my_test_law	
				cooldown = no 	
				opinion_effect = no	
			}		
			add_law = {		
				law = agnatic_succession	
				cooldown = no 	
				opinion_effect = no	
			}			
		}
		
		## Create the Judicial Central Bureau and put all the the vanilla themes under him for QOL
		roman_administration_create_bureaucrat = yes
		new_character = { save_event_target_as = target_central_judicial_official_holder }
		e_byzantium = { # Create the επί των κρίσεων / Judical Central Bureau
			create_title = {
				tier = KING
				landless = yes
				temporary = no
				rebel = no
				culture = ROOT
				name = "Epi Ton Kriseon"
				holder = event_target:target_central_judicial_official_holder
				custom_created = yes
				base_title = THIS
				copy_title_laws = yes
				mercenary = no
				adventurer = no
				ruler = "Sekreton"
				ruler_female = "Sekreton"
				foa = "My Sekreton"
			}
			new_title = {
				set_title_flag = roman_administration_central_judicial_official_bureau
				add_law = {		
					law = succ_my_test_law	
					cooldown = no 	
					opinion_effect = no	
				}				
				save_event_target_as = target_roman_administration_central_judicial_official_bureau
				holder_scope = {
					set_defacto_liege = ROOT
				}
				de_jure_liege = e_byzantium
			}
			create_title = { # Family Titular title - Create Family titular county title	
				tier = COUNT
				landless = yes
				temporary = no
				rebel = no
				culture = event_target:target_central_judicial_official_holder
				name = FAMILY_COUNT_TITLE_HIGH_OFFICE
				holder = event_target:target_central_judicial_official_holder
				custom_created = yes
				base_title = THIS
				copy_title_laws = yes
				mercenary = no
				adventurer = no
				ruler = "Eugeneios"
				ruler_female = "Eugeneia"
				foa = "My Eugeneios"
			}
			new_title = {
				set_title_flag = created_family_county_title
				# add_law = {		
					# law = succ_roman_family_elective	
					# cooldown = no 	
					# opinion_effect = no	
				# }		
				add_law = {		
					law = agnatic_succession	
					cooldown = no 	
					opinion_effect = no	
				}
			}
		}
		
		# any_title = { # Put the newly created titles under the dejure roman empire
			# limit = {
				# has_title_flag = roman_administration_central_judicial_official_bureau
			# }
			# de_jure_liege = e_byzantium
		# }		
		# any_title = { # Put the newly created titles under the dejure roman empire
			# limit = {
				# has_title_flag = roman_administration_civilian_theme
			# }
			# de_jure_liege = event_target:target_roman_administration_central_judicial_official_bureau
			# holder_scope = {
				# set_defacto_liege = event_target:target_central_judicial_official_holder
			# }
		# }
	}	

}

## Create the tagma armies
character_event = {
	id = AVE_MARIA_roman_administration.2
	hide_window = yes
	
	is_triggered_only = yes
		
	trigger = {
		is_save_game = no
		primary_title = {
			OR = { 
				title = e_byzantium
				title = e_roman_empire
			}
			has_law = succ_byzantine_elective
		}
	}
	
	immediate = {
		spawn_great_commander_effect = yes # Create a tagma - spawn commander
		new_character = { save_event_target_as = roman_administration_tagma_commander }
		e_byzantium = { # Create a Tagma - Elite Tagma Scholai
			create_title = { #Scholai
				tier = DUKE
				landless = yes
				temporary = no
				rebel = no
				culture = ROOT
				name = "Scholae Palatinae"
				holder = event_target:roman_administration_tagma_commander
				custom_created = yes
				base_title = THIS
				copy_title_laws = yes
				mercenary = no
				adventurer = no
				ruler = "Domestikos"
				ruler_female = "Domestikos"
				foa = "My Domestikos"				
			}
			new_title = {
				set_title_flag = roman_administration_tagma_title
				holder_scope = {
					set_defacto_liege = ROOT
					save_event_target_as = target_tagma_commander
					roman_administration_create_elite_cavalry_tagma = yes
				}
			}
		}
		
		spawn_great_commander_effect = yes # Create a tagma - spawn commander
		new_character = { save_event_target_as = roman_administration_tagma_commander }
		e_byzantium = { # Create a Tagma - Elite Tagma Excubitor
			create_title = { #Excubitor
				tier = DUKE
				landless = yes
				temporary = no
				rebel = no
				culture = ROOT
				name = "Excubitores"
				holder = event_target:roman_administration_tagma_commander
				custom_created = yes
				base_title = THIS
				copy_title_laws = yes
				mercenary = no
				adventurer = no
				ruler = "Archontes"
				ruler_female = "Archontes"
				foa = "My Archontes"				
			}
			new_title = {
				set_title_flag = roman_administration_tagma_title
				holder_scope = {
					set_defacto_liege = ROOT
					save_event_target_as = target_tagma_commander
					roman_administration_create_elite_cavalry_tagma = yes
				}
			}
		}
		
		spawn_great_commander_effect = yes # Create a tagma - spawn commander
		new_character = { save_event_target_as = roman_administration_tagma_commander }
		e_byzantium = { # Create a Tagma - Elite Tagma Vigla/Arithmos
			create_title = { #Vigla/Arithmos
				tier = DUKE
				landless = yes
				temporary = no
				rebel = no
				culture = ROOT
				name = "Arithmos"
				holder = event_target:roman_administration_tagma_commander
				custom_created = yes
				base_title = THIS
				copy_title_laws = yes
				mercenary = no
				adventurer = no
				ruler = "Archontes"
				ruler_female = "Archontes"
				foa = "My Archontes"				
			}
			new_title = {
				set_title_flag = roman_administration_tagma_title
				holder_scope = {
					set_defacto_liege = ROOT
					save_event_target_as = target_tagma_commander
					roman_administration_create_elite_cavalry_tagma = yes
				}
			}
		}
		
		spawn_great_commander_effect = yes # Create a tagma - spawn commander
		new_character = { save_event_target_as = roman_administration_tagma_commander }
		e_byzantium = { # Create a Tagma - Elite Tagma Hikanatoi
			create_title = { #Hikanatoi
				tier = DUKE
				landless = yes
				temporary = no
				rebel = no
				culture = ROOT
				name = "Hikanatoi"
				holder = event_target:roman_administration_tagma_commander
				custom_created = yes
				base_title = THIS
				copy_title_laws = yes
				mercenary = no
				adventurer = no
				ruler = "Archontes"
				ruler_female = "Archontes"
				foa = "My Archontes"				
			}
			new_title = {
				set_title_flag = roman_administration_tagma_title
				holder_scope = {
					set_defacto_liege = ROOT
					save_event_target_as = target_tagma_commander
					roman_administration_create_elite_cavalry_tagma = yes
				}
			}
		}
		
		# Create a Tagma - Armeniakon 1000 men
		spawn_great_commander_effect = yes # Create a tagma - spawn commander
		new_character = { save_event_target_as = roman_administration_tagma_commander }
		e_byzantium = { # Create a Tagma - Regular tagma - Armeniakon
			create_title = { #Armeniakon
				tier = DUKE
				landless = yes
				temporary = no
				rebel = no
				culture = ROOT
				name = "Armeniakon"
				holder = event_target:roman_administration_tagma_commander
				custom_created = yes
				base_title = THIS
				copy_title_laws = yes
				mercenary = no
				adventurer = no
				ruler = "Archontes"
				ruler_female = "Archontes"
				foa = "My Archontes"				
			}
			new_title = {
				set_title_flag = roman_administration_tagma_title
				holder_scope = {
					set_defacto_liege = ROOT
					save_event_target_as = target_tagma_commander
					roman_administration_create_regular_infantry_taxiarchies_tagma = yes
				}
			}
		}
		
		
		# Create a Tagma - Anatolikon 3000 men ?
		e_byzantium = { # Create a Tagma - Regular tagma - Armeniakon
			create_title = { #Hikanatoi
				tier = DUKE
				landless = yes
				temporary = no
				rebel = no
				culture = ROOT
				name = "Anatolikon"
				holder = event_target:roman_administration_tagma_commander
				custom_created = yes
				base_title = THIS
				copy_title_laws = yes
				mercenary = no
				adventurer = no
				ruler = "Archontes"
				ruler_female = "Archontes"
				foa = "My Archontes"				
			}
			new_title = {
				set_title_flag = roman_administration_tagma_title
				holder_scope = {
					set_defacto_liege = ROOT
					save_event_target_as = target_tagma_commander
					roman_administration_create_elite_cavalry_tagma = yes
				}
			}
		}
		
		# Create a Tagma - Regular tagma - 
		# e_byzantium = { # Create a Tagma - Regular tagma - Armeniakon
			# create_title = { #Hikanatoi
				# tier = DUKE
				# landless = yes
				# temporary = no
				# rebel = no
				# culture = ROOT
				# name = "Hikanatoi"
				# holder = event_target:roman_administration_tagma_commander
				# custom_created = yes
				# base_title = THIS
				# copy_title_laws = yes
				# mercenary = no
				# adventurer = no
				# ruler = "Archontes"
				# ruler_female = "Archontes"
				# foa = "My Archontes"				
			# }
			# new_title = {
				# set_title_flag = roman_administration_tagma_title
				# holder_scope = {
					# set_defacto_liege = ROOT
					# save_event_target_as = target_tagma_commander
					# roman_administration_create_elite_cavalry_tagma = yes
				# }
			# }
		# }
		
		
		
		# Create a Tagma - Ethnarchoi tagma - 400 franks/normans
		
		if = { # Create a tagma - Varangian Guard
			limit = {
				has_global_flag = varangian_guard_founded
			}
			spawn_great_commander_effect = yes # Create a tagma - spawn commander
			new_character = { save_event_target_as = roman_administration_tagma_commander }
			e_byzantium = {
				create_title = { # Varangian Guard
					tier = DUKE
					landless = yes
					temporary = no
					rebel = no
					culture = ROOT
					name = "Varangian Guard"
					holder = event_target:roman_administration_tagma_commander
					custom_created = yes
					base_title = THIS
					copy_title_laws = yes
					mercenary = no
					adventurer = no
					ruler = "Archontes"
					ruler_female = "Archontes"
					foa = "My Archontes"				
				}
				new_title = {
					set_title_flag = roman_administration_tagma_title
					set_title_flag = varangian_guard
					holder_scope = {
						set_defacto_liege = ROOT
						save_event_target_as = target_tagma_commander
						roman_administration_create_varangian_tagma = yes
					}
				}
			}
		}
		
	}
}

## Join the Imperial Society
character_event = {	
	id = AVE_MARIA_roman_administration.3
	border = GFX_event_normal_frame_diplomacy		
	desc = AVE_MARIA_roman_administration.3	
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		is_save_game = no
		primary_title = {
			OR = { 
				title = e_byzantium
				title = e_roman_empire
			}
			has_law = succ_byzantine_elective
		}
	}
	
	immediate = {
		join_society = roman_administration_imperial_court
		set_society_grandmaster = yes
		change_society_currency = 500
		any_realm_character = {
			limit = {
				roman_administration_can_join_society = yes
			}
			join_society = roman_administration_imperial_court
		}
		any_vassal = {
			limit = {
				roman_administration_can_join_society = yes
			}
			join_society = roman_administration_imperial_court
		}
	}		
	
}		

## Create the Imperial Society
character_event = {	
	id = AVE_MARIA_roman_administration.4
	border = GFX_event_normal_frame_diplomacy		
	desc = AVE_MARIA_roman_administration.4
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		is_save_game = no
		primary_title = {
			OR = { 
				title = e_byzantium
				title = e_roman_empire
			}
			has_law = succ_byzantine_elective
		}
	}
		
	immediate = {		
		join_society = imperial_court_byzantine
		set_society_grandmaster = yes
		change_society_currency = 500
		any_realm_character = {
			limit = {
				is_adult = yes
				is_female = no
			}
			join_society = imperial_court_byzantine
		}
	}		
	
}			
	
