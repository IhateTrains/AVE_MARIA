########################################################################################
#                                         											   #
# AVE MARIA events																	   #
# A Very Extensive Modification for Appropriate Realism and Improved Authenticity	   #
#                                         											   #
# ID AVE_MARIA_roman_administration.1 - AVE_MARIA_roman_administration.499			   #
#                               													   #
########################################################################################

# Written by Atreides

namespace = AVE_MARIA_roman_administration

##NOTES:
## QOL event in order not to change every single history file
## Give all titles to the roman emperor and afterwards jobs and some baronies to some great families
character_event = {
	id = AVE_MARIA_roman_administration.1
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		primary_title = {
			OR = { 
				title = e_byzantium
				title = e_roman_empire
			}
			has_law = succ_byzantine_elective
		}
	}
	
	immediate = {
		#Give all the titles to the emperor and redistribute
		any_title_under = {
			limit = {
				NOT = {
					roman_adminisration_tagma_title_held_trigger = yes
					roman_adminisration_theme_title_held_trigger = yes
					controlled_by = ROOT
					tier = baron
					title = k_orthodox
				}
			}
			gain_title = ROOT
			set_title_flag = title_to_redistribute
		}
		any_demesne_title = {
			limit = {
				has_title_flag = title_to_redistribute
				tier = duke
			}
			holder_scope = {
				create_random_steward = {
					random_traits = yes
					dynasty = random
					female = no
					attributes = {
						diplomacy = 2
						learning = 2
						stewardship = 8
						intrigue = 2
						martial = 2
					}
				}
				new_character = { save_event_target_as = theme_civilian_holder }
			}
			grant_title = { target = theme_civilian_holder }
		}
		
		# Give the offices to relevant character cause modifying history files are annoying
		#Give high offices
		
		d_nikaea_theme = {
			grant_title = { target = 41536 }
		}
	}
}

## Create the tagma armies
character_event = {
	id = AVE_MARIA_roman_administration.2
	hide_window = yes
	
	is_triggered_only = yes
	is_save_game = no
	
	trigger = {
		primary_title = {
			OR = { 
				title = e_byzantium
				title = e_roman_empire
			}
			has_law = succ_byzantine_elective
		}
	}
	
	immediate = {
		any_title_under = {
			limit = {
				title = d_scholae_palatinae
			}
			holder_scope = {
				save_event_target_as = target_tagma_commander
				roman_administration_create_regular_cavalry_tagma = yes
			}
		}
		any_title_under = {
			limit = {
				title = d_excubitor
			}
			holder_scope = {
				save_event_target_as = target_tagma_commander
				roman_administration_create_regular_cavalry_tagma = yes
			}
		}
		any_title_under = {
			limit = {
				title = d_vigla
			}
			holder_scope = {
				save_event_target_as = target_tagma_commander
				roman_administration_create_regular_cavalry_tagma = yes
			}
		}
		any_title_under = {
			limit = {
				title = d_hikanatoi
			}
			holder_scope = {
				save_event_target_as = target_tagma_commander
				roman_administration_create_regular_cavalry_tagma = yes
			}
		}
		any_title_under = {
			limit = {
				title = d_varangian_guard
			}
			holder_scope = {
				save_event_target_as = target_tagma_commander
				roman_administration_create_varangian_tagma = yes
			}
		}
	}
}