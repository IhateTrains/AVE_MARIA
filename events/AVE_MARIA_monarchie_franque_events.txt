########################################################################################
#                                         											   #
# AVE MARIA events																	   #
# A Very Extensive Modification for Appropriate Realism and Improved Authenticity	   #
#                                         											   #
# ID AVE_MARIA_monarchie_franque.1 - AVE_MARIA_monarchie_franque.499   				   #
#                               													   #
########################################################################################

# Written by Atreides

namespace = AVE_MARIA_monarchie_franque

##NOTES:
## 

# Explain coronation preparation, ask the archbishop of Reims.
character_event = {
	id = AVE_MARIA_monarchie_franque.1
	title = EVTTITLE20200
	desc = EVTDESCHF20200

	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = { #Invested by powerful Bishop
		name = EVTOPTBHF20200
		trigger = { 
			NOT = { trait = excommunicated }
			OR = { 
				lower_tier_than = EMPEROR
				# primary_title = { has_law = investiture_law_1 }
			} 
			any_tributary = {
				OR = {
					has_landed_title = c_reims
					has_landed_title = d_archreims
				}
				is_theocracy = yes 
				religion = ROOT
				NOT = { block_general_event_trigger = yes }
				OR = { 
					higher_tier_than = BARON  
					has_minor_title = title_cardinal
					has_minor_title = title_fraticelli_cardinal
					any_claim = { title = k_papal_state } #Antipope
					any_claim = { title = d_fraticelli } #Antipope
				}
				NOT = { has_landed_title = k_papal_state }
				NOT = { has_landed_title = d_fraticelli }
			}
		}
		
		any_independent_ruler = { 
			limit = {
				OR = {
					title = c_reims
					title = d_archreims
				}
				is_theocracy = yes 
				religion = ROOT
				NOT = { block_general_event_trigger = yes }
				OR = { 
					higher_tier_than = BARON  
					has_minor_title = title_cardinal
					has_minor_title = title_fraticelli_cardinal
					any_claim = { title = k_papal_state } #Antipope
					any_claim = { title = d_fraticelli } #Antipope
				}
				NOT = { has_landed_title = k_papal_state }
				NOT = { has_landed_title = d_fraticelli }
			}
			hidden_tooltip = { character_event = { id = AVE_MARIA_monarchie_franque.2 days = 30 random = 5 } } 
			break = yes
		}
		ai_chance = { 
			factor = 30
			modifier = { factor = 1 

			} 
		}
	}

	option = { #Changed your mind, not yet.
		name = EVTOPTDHF20200
		custom_tooltip = { text = coronation_canceled }
		##clr_character_flag = flag_preparing_coronation #Replaced by timed modifier
		hidden_tooltip = { remove_character_modifier = coronation_request_cooldown }
		ai_chance = { factor = 0 }	
	}
}


#Letter event for the archbishop of Reims.
character_event = {
	id = AVE_MARIA_monarchie_franque.2
	desc = EVTDESCHFA20201
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes
	trigger = {
		FROM = {
			religion = ROOT
			OR = {
				religion = catholic
				religion = fraticelli
			}
		}
	}
	
	option = { #For powerful theocrat
		name = EVTOPTBHF20201
		trigger = {
			NOR = { 
				has_landed_title = k_papal_state
				has_landed_title = d_fraticelli
			}
			OR = { 
				has_landed_title = k_papal_state
				has_landed_title = d_fraticelli
				higher_real_tier_than = BARON 
				has_minor_title = title_cardinal
				has_minor_title = title_fraticelli_cardinal
				any_claim = { title = k_papal_state } #Antipope
				any_claim = { title = d_fraticelli } 
			}
		}
		random_list = { 
			40 = { 
				modifier = {
					factor = 1.5
					trait = greedy
				}
				modifier = {
					factor = 1.25
					trait = slothful
				}
				modifier = {
					factor = 1.25
					trait = envious
				}
				modifier = {
					factor = 0
					NOT = { 
						opinion = { 
							who = FROM
							value = -100 
						} 
					}
				}
				modifier = {
					factor = 0.5
					NOT = { 
						opinion = { 
							who = FROM
							value = -80 
						} 
					}
				}
				modifier = {
					factor = 0.6
					NOT = { 
						opinion = { 
							who = FROM
							value = -60 
						} 
					}
				}
				modifier = {
					factor = 0.7
					NOT = { 
						opinion = { 
							who = FROM
							value = -40 
						} 
					}
				}
				modifier = {
					factor = 0.8
					NOT = { 
						opinion = { 
							who = FROM
							value = -20 
						} 
					}
				}
				FROM = { letter_event = { id = HF.20204 } } #Donate money to me.
			} 
			40 = { 
				modifier = {
					factor = 0
					rightful_religious_head_scope = { character = ROOT }
				}
				modifier = {
					factor = 0
					OR = { 
						trait = cynical 
						trait = bad_priest_christian
					}
				}
				modifier = {
					factor = 1.5
					trait = charitable
				}
				modifier = {
					factor = 1.5
					trait = zealous
				}
				modifier = {
					factor = 0.5
					trait = bad_priest_christian
				}
				modifier = { 	#Antipope more likely to ask for little
					factor = 1.5
					has_opinion_modifier = { 
						who = FROM 
						modifier = opinion_controlled_antipope 
					}
				}
				modifier = { 	#Supported Cardinal more likely to ask for little
					factor = 1.5
					has_opinion_modifier = { 
						who = FROM 
						modifier = opinion_supported_cardinal 
					}
				}
				modifier = {
					factor = 0
					NOT = { 
						opinion = { 
							who = FROM
							value = -100 
						} 
					}
				}
				modifier = {
					factor = 0.5
					NOT = { 
						opinion = { 
							who = FROM
							value = -80 
						} 
					}
				}
				modifier = {
					factor = 0.6
					NOT = { 
						opinion = { 
							who = FROM
							value = -60 
						} 
					}
				}
				modifier = {
					factor = 0.7
					NOT = { 
						opinion = { 
							who = FROM
							value = -40 
						} 
					}
				}
				modifier = {
					factor = 0.8
					NOT = { 
						opinion = { 
							who = FROM
							value = -20 
						} 
					}
				}
				FROM = { letter_event = { id = HF.20205 } } #Donate money to the Pope.
			} 
			20 = { 
				trigger = {
					FROM = { 
						any_child = { 
							age = 16
							is_married = no
							is_ruler = no
							prisoner = no
							NOT = { trait = incapable }
							FROM = {
								NOT = { 
									current_heir = { character = PREVPREV }
								}
							}
							NOR = { 
								trait = monk 
								trait = nun
							} 
						}
					}
				}
				modifier = {
					factor = 1.5
					FROM = { 
						any_child = { 
							count = 3
							age = 16
							is_married = no
							is_ruler = no
							prisoner = no
							NOT = { trait = incapable }
							FROM = {
								NOT = { 
									current_heir = { character = PREVPREV }
								}
							}
							NOR = { 
								trait = monk 
								trait = nun
							} 
						}
					}
				}
				modifier = {
					factor = 1.5
					FROM = { 
						any_child = { 
							count = 4
							age = 16
							is_married = no
							is_ruler = no
							prisoner = no
							NOT = { trait = incapable }
							FROM = {
								NOT = { 
									current_heir = { character = PREVPREV }
								}
							}
							NOR = { 
								trait = monk 
								trait = nun
							} 
						}
					}
				}
				modifier = {
					factor = 1.5
					FROM = { 
						any_child = { 
							count = 5
							age = 16
							is_married = no
							is_ruler = no
							prisoner = no
							NOT = { trait = incapable }
							FROM = {
								NOT = { 
									current_heir = { character = PREVPREV }
								}
							}
							NOR = { 
								trait = monk 
								trait = nun
							} 
						}
					}
				}
				modifier = {
					factor = 1.5
					FROM = { 
						any_child = { 
							count = 6
							age = 16
							is_married = no
							is_ruler = no
							prisoner = no
							NOT = { trait = incapable }
							FROM = {
								NOT = { 
									current_heir = { character = PREVPREV }
								}
							}
							NOR = { 
								trait = monk 
								trait = nun
							} 
						}
					}
				}
				modifier = {
					factor = 0.25
					trait = bad_priest_christian
				}
				modifier = {
					factor = 0.25
					trait = cynical
				}
				FROM = { letter_event = { id = HF.20206 } } #Send child to monastery/nunnery.
			} 
			10 = { 
				trigger = { #Check if holy orders exist.
					OR = { 
						is_title_active = d_knights_templar 
						is_title_active = d_teutonic_order 
						is_title_active = d_knights_hospitaler 
						is_title_active = d_knights_santiago 
						is_title_active = d_knights_calatrava 
					}
					FROM = { 
						any_child = { 
							age = 16
							is_ruler = no
							is_female = no
							prisoner = no
							NOT = { trait = incapable }
							vassal_of = FROM
							ROOT_FROM = {
								NOT = { 
									current_heir = { character = PREVPREV  }
								}
							}
							NOR = { 
								trait = monk 
								trait = nun
							} 
						}
					}
				}
				modifier = {
					factor = 1.5
					FROM = { 
						any_child = { 
							count = 3
							age = 16
							is_ruler = no
							is_female = no
							prisoner = no
							NOT = { trait = incapable }
							vassal_of = FROM
							FROM = {
								NOT = { 
									current_heir = { character = PREVPREV  }
								}
							}
							NOR = { 
								trait = monk 
								trait = nun
							} 
						}
					}
				}
				modifier = {
					factor = 1.5
					FROM = { 
						any_child = { 
							count = 4
							age = 16
							is_ruler = no
							is_female = no
							prisoner = no
							NOT = { trait = incapable }
							vassal_of = FROM
							FROM = {
								NOT = { 
									current_heir = { character = PREVPREV  }
								}
							}
							NOR = { 
								trait = monk 
								trait = nun
							} 
						}
					}
				}
				modifier = {
					factor = 1.5
					FROM = { 
						any_child = { 
							count = 5
							age = 16
							is_ruler = no
							is_female = no
							prisoner = no
							NOT = { trait = incapable }
							vassal_of = FROM
							FROM = {
								NOT = { 
									current_heir = { character = PREVPREV  }
								}
							}
							NOR = { 
								trait = monk 
								trait = nun
							} 
						}
					}
				}
				modifier = {
					factor = 1.5
					FROM = { 
						any_child = { 
							count = 6
							age = 16
							is_ruler = no
							is_female = no
							prisoner = no
							NOT = { trait = incapable }
							vassal_of = FROM
							FROM = {
								NOT = { 
									current_heir = { character = PREVPREV  }
								}
							}
							NOR = { 
								trait = monk 
								trait = nun
							} 
						}
					}
				}
				modifier = {
					factor = 0.25
					trait = bad_priest_christian
				}
				modifier = {
					factor = 0.25
					trait = cynical
				}
				FROM = { letter_event = { id = HF.20207 } } #Send son to holy order.
			} 
			10 = { 
				trigger = {
					FROM = { war = no }
				}
				modifier = {
					factor = 0
					NOT = { trait = bad_priest_christian }
					NOT = { trait = hedonist }
				}
				modifier = {
					factor = 0
					OR = {
						 trait = celibate
						 trait = temperate
					}
				}
				modifier = {
					factor = 1.5
					trait = gluttonous
				}
				modifier = {
					factor = 1.5
					trait = drunkard
				}
				modifier = {
					factor = 1.5
					trait = greedy
				}
				modifier = {
					factor = 1.25
					trait = cynical
				}
				modifier = {
					factor = 0.5
					trait = zealous
				}
				FROM = { letter_event = { id = HF.20208 } } #Wishes to have orgy for himself.
			} 
			10 = { 
				modifier = {
					factor = 0
					NOT = {
						FROM = {
							any_demesne_title = {
								can_be_given_away = yes
								tier = count
								is_feudal = yes
								location = {
									is_capital = no
								}
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					FROM = {
						any_demesne_title = {
							can_be_given_away = yes
							tier = count
							is_feudal = yes
							count = 2
							location = {
								is_capital = no
							}
						}
					}
				}
				modifier = {
					factor = 2
					FROM = {
						any_demesne_title = {
							can_be_given_away = yes
							tier = count
							is_feudal = yes
							count = 5
							location = {
								is_capital = no
							}
						}
					}
				}
				FROM = { letter_event = { id = HF.20209 } } #Wishes for another County.
			} 
			10 = { 
				modifier = {
					factor = 0
					FROM = {
						is_monastic_member_trigger = yes
					}
				}
				modifier = {
					factor = 0
					is_monastic_member_trigger = no
				}
				modifier = {
					factor = 1.5
					trait = zealous
				}
				modifier = {
					factor = 1.5
					trait = scholar
				}
				modifier = {
					factor = 1.5
					trait = socializer
				}
				modifier = {
					factor = 1.25
					trait = gregarious
				}
				FROM = { letter_event = { id = HF.20210 } } #Join my Monastic Order.
			}
			10 = { 
				modifier = {
					factor = 0
					NOT = {
						FROM = {
							any_artifact = { 
								has_artifact_flag = christian 
								NOR = { 
									has_artifact_flag = rare
									has_artifact_flag = very_rare
								}
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					trait = zealous
				}
				modifier = {
					factor = 1.5
					trait = scholar
				}
				modifier = {
					factor = 1.5
					trait = theologian
				}
				modifier = {
					factor = 1.5
					trait = mystic
				}
				FROM = { letter_event = { id = HF.20240 } } #Give me a relic.
			} 
		}
	}

}