###################################
#
# CHARLEMAGNE
# - Councillor decisions
#
###################################

# Written by Henrik "Groogy" Hansson

decisions = {
	help_liege_manage_titles = {
		ai = no
		is_high_prio = yes

		potential = {
			is_councillor = yes
			OR = {
				has_job_title = job_chancellor
				has_job_title = job_treasurer
				has_job_title = job_spiritual
			}
			NOR = {
				had_character_flag = { flag = proposed_to_help_liege_with_titles days = 730 }
				independent = yes # CleanSlate: This may be redundant but the original code checked for it.
				trait = slothful
			}
			liege = {
				is_nomadic = no
				# CleanSlate: The below were originally in the Allow section. Moved to potential to de-clutter the decisions
				over_max_demesne_size = 4
				OR = {
					NOT = { has_character_flag = has_been_proposed_about_titles }
					had_character_flag = { flag = has_been_proposed_about_titles days = 14 }
				}
				OR = {
					NOT = { has_character_flag = refused_any_help_with_titles }
					had_character_flag = { flag = refused_any_help_with_titles days = 712 }
				}
				OR = {
					NOT = { has_character_flag = getting_help_with_titles }
					had_character_flag = { flag = getting_help_with_titles days = 800 }
				}
			}
		}

		allow = {
			always = yes
		}

		effect = {
			set_character_flag = proposed_to_help_liege_with_titles
			liege = {
				set_character_flag = has_been_proposed_about_titles
			}
			trigger_switch = {
				on_trigger = has_job_title
				job_chancellor = { character_event = { id = 108050 } }
				job_treasurer = { character_event = { id = 108051 } }
				job_spiritual = { character_event = { id = 108052 } }
			}
		}

		ai_will_do = {
			factor = 0
		}

	}

	ask_help_to_manage_titles = {
		only_playable = yes

		ai_check_interval = 12
	 	is_high_prio = yes

		potential = {
			is_nomadic = no
			over_max_demesne_size = 4
			job_chancellor = { is_alive = yes }
			OR = {
				NOT = { has_character_flag = has_been_proposed_about_titles }
				had_character_flag = { flag = has_been_proposed_about_titles days = 14 }
			}
			OR = {
				NOT = { has_character_flag = refused_any_help_with_titles }
				had_character_flag = { flag = refused_any_help_with_titles days = 712 }
			}
			OR = {
				NOT = { has_character_flag = getting_help_with_titles }
				had_character_flag = { flag = getting_help_with_titles days = 800 }
			}
		}

		allow = {
			trigger_if = {
				limit = {
					ai = yes
				}
				job_chancellor = { ai = no }
			}
		}

		effect = {
			set_character_flag = getting_help_with_titles
			job_chancellor = {
				character_event = { id = 108010 }
				character_event = { id = 108005 }
			}
		}

		ai_will_do = {
			factor = 1
		}

	}
}
